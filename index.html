<!--
Linux User Group Guangzhou Node.js Share

Authors: Haosdent Huang <haosdent@gmail.com>

URL: https://github.com/haosdent
-->
<!DOCTYPE html>
<html>
<head>
  <title>Node.js Share</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="logoslide nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/hci_logo.png"></span>
    </article>
  </slide>

  <slide class="title-slide segue nobackground">
    <aside class="gdbar"><img src="images/hci_icon_128.png"></aside>
    <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>什么是Node.js</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>一个JavaScirpt的服务器端运行时，基于V8引擎
          <ul class="build">
            <li>并非第一个JavaScript服务器端运行时（Netscape的LiveWire）</li>
            <li>亦非唯一一个JavaScript服务器端运行时（基于Mozilla Rhino的RingoJS）</li>
          </ul>
        </li>
        <li>实现了CommonJS规范
	  <ul class="build">
	    <li>系统API，I/O，网络...</li>
	  </ul>
	  <ul class="build">
	    <li>JavaScript - DOM - BOM = ECMAScript</li>
	    <li>ECMAScript + Package +  ... = CommonJS</li>
	  </ul>
        </li>
      </ul>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right bottom"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Node.js的发展历程</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>发展历程</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>2009年02月，Ryan Dahl宣布准备基于V8创建一个轻量级的Web服务器并提供一套类库。</li>
        <li>2009年05月，Ryan Dahl于GitHub发布了最初版本的Node.js包，随后数月，有人开始使用Node.js开发应用。</li>
        <li>2009年11月，JSConf大会开始每年都安排Node.js的讲座。</li>
        <li>2010年年底，云计算服务商Joyent资助Node.js，Ryan Dahl加入Joyent全职负责Node.js的发展。</li>
        <li>201x年xx月，......</li>
        <li>2012年10月，Node.js 0.9.3 Version(Unstable)</li>
      </ul>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right bottom"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>应用案例</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2><img src="images/linkedin_logo.png" alt="Linkedin" title="Linkedin"></h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/example_linkedin.png" alt="Linkedin" title="Linkedin">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2><img src="images/taobao_logo.jpg" alt="Linkedin" title="Linkedin"></h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/example_taobaoshu.png" alt="淘宝指数" title="淘宝指数"></p>
      <p><img src="images/example_taobaomo.jpg" alt="数据魔方" title="数据魔方"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>更多中国用户案例</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p>
	<img src="images/example_xueqiu.jpg" alt="雪球财经" title="雪球财经">
	<img src="images/example_pengyou.jpg" alt="雪球财经" title="雪球财经">
      </p>
      <p>
	<img src="images/example_meili.jpg" alt="美丽说" title="美丽说" height="180px">
	<img src="images/example_huaban.gif" alt="花瓣" title="花瓣" height="180px">
      </p>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right bottom"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Node.js的特点</h2>
    </hgroup>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>事件机制</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>传统机制之CPU分片</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/analyze_singlecpu.jpg" alt="SingleCpu" title="SingleCpu"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>传统机制之多进程并发</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/analyze_multicpu.jpg" alt="MultiCpu" title="MultiCpu" height="550px"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>同步IO</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/analyze_io.jpg" alt="IO" title="IO"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>异步IO</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/analyze_aio.jpg" alt="AIO" title="AIO"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>异步回调</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/analyze_async.png" alt="ASync" title="ASync"></p>
    </article>
  </slide>

  <slide>
    <article class="flexbox vcenter">
      <h1 style="font-size: 50px;">借助异步在单线程上突破性能瓶颈</h1>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Faster than C!</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/analyze_performance.png" alt="FasterThanC" title="FasterThanC" height="550px;">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>5000Mbit/s</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/analyze_performance2.png" alt="FasterThanC" title="FasterThanC" height="550px;">
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>模块机制</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>模块使用示例</h2>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="javascript">
	/* @文件名: Math.js */
	module.exports = {
	  PI: 3.1415
	};
      </pre>

      <pre class="prettyprint" data-lang="javascript">
	/* @文件名: Circle.js */
	var Math = <b>require('./Math');</b>
	var area = function(r){
	  return Math.PI * r * r;
	};
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>模块分类</h2>
    </hgroup>
    <article>
      <ul class="build">
	<li>核心模块(已编译进二进制执行文件)</li>
	<li>文件模块(动态加载)
	  <ul class="build">
	    <li>js格式</li>
	    <li>node格式(由C++写)</li>
	    <li>json格式</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>模块加载之包装</h2>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="javascript">
	<b>(function(exports, require, module, __filename, __dirname){</b>

	  /* @文件名: Circle.js */
	  var Math = <b>require('./Math');</b>
	  var area = function(r){
	    return Math.PI * r * r;
	  };
	<b>});</b>
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>模块加载</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/analyze_loadmodule.jpg" alt="LoadModule" title="LoadModule" height="550px"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>npmjs.org</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/example_npm.jpg" alt="NPM" title="NPM"></p>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right bottom"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>应用场景</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Real-Time</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>场景特点
	  <ul class="build">
	    <li>业务逻辑简单， 功能单一</li>
	    <li>无页面逻辑，维持长连接，push json/xml数据到客户端</li>
	    <li>IO并发要求极高，单机需维持上万长连接</li>
	  </ul>
	</li>
        <li>常用编程语言
	  <ul>
	    <li>node.js</li>
	    <li>Go</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Real-Time</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/example_pomelo.png" alt="pomelo" title="pomelo" height="400px"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Web API Service</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>场景特点
	  <ul class="build">
	    <li>业务逻辑比较简单， 功能点较少</li>
	    <li>无页面逻辑，输出json/xml数据</li>
	    <li>IO并发要求比较高，上千上万的并发</li>
	  </ul>
	</li>
        <li>常用编程语言
	  <ul>
	    <li>Java/.NET</li>
	    <li>node.js</li>
	    <li>Go</li>
	    <li>Python/Ruby</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Web API Service</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <p><img src="images/example_myfox.png" alt="myfox" title="myfox"></p>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Unix tools</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>场景特点
	  <ul class="build">
	    <li>处理文本流</li>
	    <li>标准输入输出，网络支持</li>
	    <li>开发便捷</li>
	    <li>爬虫</li>
	  </ul>
	</li>
        <li>常用编程语言
	  <ul>
	    <li>Shell</li>
	    <li>Python/Ruby</li>
	    <li>Node.js</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>单一页面应用</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>场景特点
	  <ul class="build">
	    <li>通过大量Ajax请求与后端交互</li>
	    <li>后端无需页面逻辑，与前端交互数据类型为json/xml</li>
	    <li>IO并发要求比较高，成千上万的并发数</li>
	  </ul>
	</li>
        <li>常用编程语言
	  <ul>
	    <li>Java/.NET</li>
	    <li>node.js</li>
	    <li>Python/Ruby</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right bottom"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Node.js的局限及解决</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>CPU密集型应用</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/solution_singleprocess.jpg" alt="SingleProcess" title="SingleProcess">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>CPU密集型应用</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>起因
	  <ul class="build">
	    <li>单线程</li>
	  </ul>
	</li>
        <li>解决方案
	  <ul>
	    <li>将耗时的模块替换成C++(node-gyp)</li>
	    <li>Child Process或Cluster worker</li>
	    <li>借助第三库</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>CPU密集型应用</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/solution_worker.png" alt="Worker" title="Worker">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>深度嵌套回调</h2>
    </hgroup>
    <article>
      <h3>获取模板->获取数据->进行本地化(同步)<h3>
      <pre class="prettyprint" data-lang="java">
	Template template = Template.get('id'); // 获取模板
	Data data = Data.get('id'); // 获取数据

	data = I10n.convert(data); // 本地化相关工作

	return render(template, data); //渲染出最终结果
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>深度嵌套回调</h2>
    </hgroup>
    <article>
      <h3>获取模板->获取数据->进行本地化(异步)<h3>
      <pre class="prettyprint" data-lang="javascript">
	$.get("template", function(template){
	  // 获取模板
	  $.get("data", function(data){
	    // 获取数据
            $.get("l10n", function(l10n){
	      // 本地化相关工作
              render(template, data);//渲染出最终结果
            });
	  });
	});
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>深度嵌套回调</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>起因
	  <ul class="build">
	    <li>异步</li>
	  </ul>
	</li>
        <li>解决方案
	  <ul>
	    <li>事件监听: 继承EventEmitter</li>
	    <li>Promises: node-promise</li>
	    <li>同步: Wind.js, streamline.js</li>
	    <li>纤程或协程: node-fibers, js-coroutine</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>多核CPU利用率</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/example_singlecpu.png" alt="SingleCpu" title="SingleCpu" height="270px">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>多核CPU利用率</h2>
    </hgroup>
    <article>
      <ul class="build">
        <li>起因
	  <ul class="build">
	    <li>单线程</li>
	  </ul>
	</li>
        <li>解决方案
	  <ul>
	    <li>Node.js自带Cluster模块</li>
	    <li>开启多个进程，借助Nginx等反向代理负载均衡到各个进程</li>
	  </ul>
	</li>
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>多核CPU利用率</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/example_singlecpu.png" alt="SingleCpu" title="SingleCpu" height="270px">
      <img src="images/example_multicpu.png" alt="MultiCpu" title="MultiCpu" height="270px">
    </article>
  </slide>

  <slide class="segue dark nobackground">
    <aside class="gdbar right bottom"><img src="images/hci_icon_128.png"></aside>
    <hgroup class="auto-fadein">
      <h2>Node.js的相关框架</h2>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>Express</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/framework_express.png" alt="Express" title="Express">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Connect</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/framework_connect.png" alt="Connect" title="Connect">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Meteor</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <img src="images/framework_meteor.png" alt="Meteor" title="Meteor">
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Meteor Demo</h2>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="javascript">
      Users = new Meteor.Collection('users');

      if(Meteor.isClient){
        Template.inc.events({
          'click h1': function(){
            var user = {name: 'test'};
            Users.insert(user);
          }
        });

        Template.inc.count = function(){
          return Users.find().count();
        };
      }
      </pre>
      <pre class="prettyprint" data-lang="html">
	&lt;body>
	  {{> inc}}
	&lt;/body>

	&lt;template name="inc">
	  &lt;h1>Number(Click me):{{count}}&lt;h1>
	&lt;/template>
      </pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Meteor Demo</h2>
    </hgroup>
    <article>
      <iframe data-src="http://localhost:3000" class="half-width"></iframe>
      <iframe data-src="http://localhost:3000" class="half-width"></iframe>
    </article>
  </slide>

  <slide class="thank-you-slide segue nobackground">
    <aside class="gdbar right"><img src="images/hci_icon_128.png"></aside>
    <article class="flexbox vleft auto-fadein">
      <h2>谢谢</h2>
      <p>欢迎交流。</p>
    </article>
    <p class="auto-fadein" data-config-contact>
      <!-- populated from slide_config.json -->
    </p>
  </slide>

  <slide class="logoslide dark nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/hci_logo_white.png"></span>
    </article>
  </slide>

  <slide class="backdrop"></slide>

</slides>

<script>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXXX-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
